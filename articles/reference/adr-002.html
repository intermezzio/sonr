<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/adr-002">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<title data-rh="true">ADR-002 | Sonr Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://sonr-io.github.io/articles/reference/adr-002"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ADR-002 | Sonr Docs"><meta data-rh="true" name="description" content="hackmd-github-sync-badge"><meta data-rh="true" property="og:description" content="hackmd-github-sync-badge"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sonr-io.github.io/articles/reference/adr-002"><link data-rh="true" rel="alternate" href="https://sonr-io.github.io/articles/reference/adr-002" hreflang="en"><link data-rh="true" rel="alternate" href="https://sonr-io.github.io/articles/reference/adr-002" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.bbb29084.css">
<link rel="preload" href="/assets/js/runtime~main.8169f229.js" as="script">
<link rel="preload" href="/assets/js/main.a70c422f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Sonr Docs Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="Sonr Docs Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><a class="navbar__item navbar__link" href="/articles/introduction">Learn the Basics</a><a class="navbar__item navbar__link" href="/articles/run-nodes/setup-validator">Run Nodes</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Build Apps</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/articles/highway-sdk/using-cli">Highway SDK</a></li><li><a class="dropdown__link" href="/articles/motor-node/installation">Motor Library</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-overview">ADR Overview</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-001">ADR-001</a></li><li><a aria-current="page" class="dropdown__link navbar__link--active" href="/articles/reference/adr-002">ADR-002</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-003">ADR-003</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-004">ADR-004</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-005">ADR-005</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-006">ADR-006</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">API Reference</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/highway">üõ£ Highway API</a></li><li><a class="dropdown__link" href="/blockchain">‚õì Blockchain API</a></li></ul></div><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-001">ADR-001</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/articles/reference/adr-002">ADR-002</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-003">ADR-003</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-004">ADR-004</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-005">ADR-005</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-006">ADR-006</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">ADR-002</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ADR-002: IPLD Objects With JOSE</h1><p><a href="https://hackmd.io/iomfscGXR1ycI_67NrLvMw" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://hackmd.io/iomfscGXR1ycI_67NrLvMw/badge" alt="hackmd-github-sync-badge" class="img_E7b_"></a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">‚Äã</a></h2><p>Implement Object Schemas based on <a href="https://ipld.io" target="_blank" rel="noopener noreferrer">IPLD</a> which support <a href="https://jose.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">JOSE</a> operations.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="abstract">Abstract<a class="hash-link" href="#abstract" title="Direct link to heading">‚Äã</a></h2><p>Objects on the Sonr network provide a way for users and applications to persist data.
The problem with modern software architectures is that the security of user data is not guaranteed‚Äîa problem Sonr aims to solve with the help of JavaScript Object Signing and Encryption (JOSE).</p><p>Additionally, today‚Äôs software stack is not built with interoperability in mind.
An entire layer must be added to any application to support communication with other applications. IPLD provides a standard and decentralized way for any motor node to make use of the data stored on Sonr.</p><p>The combining of these technologies begets a system in which user data is always encrypted and can never be owned by one application, not even the application that created it.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="primer">Primer<a class="hash-link" href="#primer" title="Direct link to heading">‚Äã</a></h2><p>The content of this ADR is based on the works of ADR-001 as well as a few core technologies‚Äîall of which should be well understood before reading ADR-002. Here is a list of resources.</p><ul><li><a href="/articles/reference/adr-001">ADR-001</a></li><li><a href="https://ipld.io/docs/intro/primer/" target="_blank" rel="noopener noreferrer">IPLD Primer</a></li><li><a href="https://docs.ipfs.io/concepts/" target="_blank" rel="noopener noreferrer">IPFS Concepts</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="glossary">Glossary<a class="hash-link" href="#glossary" title="Direct link to heading">‚Äã</a></h2><h4 class="anchor anchorWithStickyNavbar_mojV" id="json-web-signature-jws"><code>JSON Web Signature (JWS)</code><a class="hash-link" href="#json-web-signature-jws" title="Direct link to heading">‚Äã</a></h4><p>JavaScript Object Notation (JSON) data structure that represents a cryptographic key.
This specification also defines a JWK Set JSON data structure that represents a set of JWKs.
Cryptographic algorithms and identifiers for use with this specification are described in the separate JSON Web Algorithms (JWA) specification and IANA registries established by that specification.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="json-web-encryption-jwe"><code>JSON Web Encryption (JWE)</code><a class="hash-link" href="#json-web-encryption-jwe" title="Direct link to heading">‚Äã</a></h4><p>JSON Web Encryption (JWE) represents encrypted content using JSON-based data structures.
Cryptographic algorithms and identifiers
for use with this specification are described in the separate JSON Web Algorithms (JWA) specification and IANA registries defined by that specification.  Related digital signature and Message Authentication Code (MAC) capabilities are described in the separate JSON Web Signature (JWS) specification.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="json-web-key-jwk"><code>JSON Web Key (JWK)</code><a class="hash-link" href="#json-web-key-jwk" title="Direct link to heading">‚Äã</a></h4><p>A JSON Web Key (JWK) is a JavaScript Object Notation (JSON) data structure that represents a cryptographic key.  This specification also defines a JWK Set JSON data structure that represents a set of JWKs.
Cryptographic algorithms and identifiers for use with this
specification are described in the separate JSON Web Algorithms (JWA)
specification and IANA registries established by that specification.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="schema"><code>Schema</code><a class="hash-link" href="#schema" title="Direct link to heading">‚Äã</a></h4><p>A definition that outlines a structure for data to be stored within a persistence layer. These structures conform to a standard of <code>key value pairs</code> where the <code>key</code> is a string and the value is one of a set number of <code>Types</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="identity"><code>Identity</code><a class="hash-link" href="#identity" title="Direct link to heading">‚Äã</a></h3><p>An identity is derived from the user&#x27;s provided key upon registration.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="objective">Objective<a class="hash-link" href="#objective" title="Direct link to heading">‚Äã</a></h2><p>The objective of ADR-002 is to define how Sonr manages the creation and access of data on its network. A proper solution must have these attributes.</p><ul><li>Enable <em>motor</em> nodes to store data on behalf of a user.</li><li>Enable devices which belong to the same user to access the same data.</li><li>Enable certain data to be shared with other users.</li><li>Allow for revoking access to both devices and other users.</li><li>Maintain that all data is encrypted in transit and at rest.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="changes-from-adr-001">Changes From ADR-001<a class="hash-link" href="#changes-from-adr-001" title="Direct link to heading">‚Äã</a></h2><p>To accommodate the features proposed by ADR-002, a few changes to terminology will be made from ADR-001.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="rename-object-to-schema">Rename <strong>Object</strong> to <strong>Schema</strong><a class="hash-link" href="#rename-object-to-schema" title="Direct link to heading">‚Äã</a></h4><p><em>Object</em> in ADR-001 represents a type definition in Sonr. This name is misleading as it creates ambiguity between the type definition and the data which is of that type. With the addition of IPLD, the term <em>Schema</em> will better express the concepts that were represented by <em>Object</em> while creating consistency with the libraries we employ.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="client-side-encryption-with-jose">Client-Side Encryption with JOSE<a class="hash-link" href="#client-side-encryption-with-jose" title="Direct link to heading">‚Äã</a></h2><p>A core principle of Sonr is to never let private user data pass unencrypted through the network. To achieve this, the <em>motor</em> node must be responsible for encrypting and decrypting all data. This section describes how a user may securely store data on Sonr and maintain the ability to access that data from any <em>motor</em> associated with his/her account.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="encryption">Encryption<a class="hash-link" href="#encryption" title="Direct link to heading">‚Äã</a></h3><p>In order for encrypted data to be accessed from multiple devices, there must be a <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm" target="_blank" rel="noopener noreferrer">shared key</a> for each piece of data that will be accessible to each <em>motor</em>. </p><h4 class="anchor anchorWithStickyNavbar_mojV" id="key-creation">Key Creation<a class="hash-link" href="#key-creation" title="Direct link to heading">‚Äã</a></h4><p>The <a href="https://jose.readthedocs.io/en/latest/#jwk" target="_blank" rel="noopener noreferrer">JWK</a> used during the encryption process is determined by the access levels for the data. As the owner of data, the user <code>bucket</code> will contain a map of encrypted JWKs: <code>map[CID]map[PK]JWK</code> <!-- -->[henceforth referenced to as the Object Encryption Key Map (OEKM)]<!-- -->; where CID is the CID of the object, PK is the public key of a member who has access, and JWK is the JWK used to encrypt the data.</p><p>For objects shared with other users, the OEKM may exist in a dedicated bucket, but this is an implementation detail for the developer.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="client">Client<a class="hash-link" href="#client" title="Direct link to heading">‚Äã</a></h4><ol><li>An object is created using a <em>Schema</em>‚Äîthis is what will be stored.</li><li>The <em>motor</em> encrypts the data using its shared key for private data. If the data is meant to be shared with a party, a key specific to that party is used.<ul><li>Any property in the data that is represented as a separate <em>Schema</em> will be encrypted separately and included with the POST request.</li><li>Each encrypted <em>schema</em> will also have a corresponding CID. Because CIDs are generated predictably, this will be computed by the <em>motor</em>.</li></ul></li><li>The <em>motor</em> then creates a copy of the key it generated and encrypts it with each public key in the root-level DID. This is ultimately what allows another <em>motor</em> to decrypt the data.</li><li>A request can now be crafted to Highway with the encrypted data and set of encrypted keys.<ul><li>The request should include each encrypted <em>schema</em> along with the list of encrypted shared keys.</li></ul></li></ol><p><a href="https://www.figma.com/file/URTnRygutbDRaSK0swKVyV/Reading%2FWriting-Encrypted-User-Data?node-id=190%3A148" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Writing encrypted data" src="/assets/images/writing-encrypted-data-adr-2-d14034625257e95572ab1d0a17594959.png" width="1275" height="828" class="img_E7b_"></a></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="server">Server<a class="hash-link" href="#server" title="Direct link to heading">‚Äã</a></h4><ol><li>When a request is received, each object is added to IPFS.</li><li>The CID for each object will be verified, creating an error if one does not match.</li><li>If successful, each CID is added to a record on-chain. Alternatively, each CID may be be part of a bucket update and not stored individually on-chain.</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="decrypting">Decrypting<a class="hash-link" href="#decrypting" title="Direct link to heading">‚Äã</a></h3><p>The process for decrypting data becomes simple with the above provisions. The <em>motor</em> will first obtain the shared key‚Äîaccessible via the <em>vault</em> (more on that later)‚Äîwhich will be used to encrypt data fetched through IPFS. The entire process is as follows.</p><ol><li>Fetch the shared key and decrypt it.<ul><li>The shared key will have already been added to the <em>vault</em> by the uploading device. This process is outlined in the next section.</li></ul></li><li>Through IPFS, fetch the relevant data via CID. Then, fetch each referenced CID in the result. Continue this process until all objects have been recovered.</li><li>Decrypt each object using the shared key.</li><li>Compose the original <em>schema</em> by replacing the IPLD Link with the referenced object.</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="revoking-access">Revoking Access<a class="hash-link" href="#revoking-access" title="Direct link to heading">‚Äã</a></h3><p>If any device or party is to have its access revoked, a new key must be used for the next update to that object. This means the process for revoking access is to simply upload the object again, with the revoked party omitted from the OEKM.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="a-note-on-the-vault">A Note on the Vault<a class="hash-link" href="#a-note-on-the-vault" title="Direct link to heading">‚Äã</a></h4><p>Each user on Sonr will have a bucket created for them when they create an account, known as their <em>vault</em>. The vault acts as a collection of all the user&#x27;s personal keys or private data. Buckets and vaults will be covered in great detail in ADR-003.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="adding-verification-methods">Adding Verification Methods<a class="hash-link" href="#adding-verification-methods" title="Direct link to heading">‚Äã</a></h2><p>The process of securing user data starts with the verification method. Simply put, verification methods are a member of the DID Document which contain the public keys used for authentication. New verification methods can be added in order for a user to authenticate with new or different keys. Later sections will detail how these methods are used to create JWKs for secure data storage.</p><p>The important thing to note about Verification Methods in ADR-002 is that the process for adding a Verification Method must now include encrypting all shared keys again with the new method‚Äôs public key.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="schema-model">Schema Model<a class="hash-link" href="#schema-model" title="Direct link to heading">‚Äã</a></h2><p>A <em>schema</em> added to Sonr will have the following format.</p><div class="codeBlockContainer_I0IT language-go= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-go= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">type Schema struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Did string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Label string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Fields map[string]SchemaKind</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type SchemaKind int32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const (</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Invalid SchemaKind = iota</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Map</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_List</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Unit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Bool</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Float</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_String</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Bytes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Link</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Struct</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Union</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Enum</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SchemaKind_Any</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="did">Did<a class="hash-link" href="#did" title="Direct link to heading">‚Äã</a></h4><p>The DID that uniquely identifies the Schema.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="label">Label<a class="hash-link" href="#label" title="Direct link to heading">‚Äã</a></h4><p>A name for this schema.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="fields">Fields<a class="hash-link" href="#fields" title="Direct link to heading">‚Äã</a></h4><p>A list of properties for this schema.
The property types are defined as <code>SchemaKind</code>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="object-model">Object Model<a class="hash-link" href="#object-model" title="Direct link to heading">‚Äã</a></h2><p>Object data on Sonr will be encrypted, but IPFS will contain a wrapper of that data containing some additional metadata.</p><div class="codeBlockContainer_I0IT language-go= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-go= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">type Object struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Content []byte</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EncryptedJWKs map[PublicKey]EncryptedJWK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type PublicKey string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type EncryptedJWK string</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="content">Content<a class="hash-link" href="#content" title="Direct link to heading">‚Äã</a></h4><p>The raw content of this object. May be encrypted with a JWK.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="encryptedjwks">EncryptedJWKs<a class="hash-link" href="#encryptedjwks" title="Direct link to heading">‚Äã</a></h4><p>A mapping of each public key that has access to the data with the JWK encrypted with said public key.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="object-schema-api-blockchain">Object Schema API (Blockchain)<a class="hash-link" href="#object-schema-api-blockchain" title="Direct link to heading">‚Äã</a></h2><p>The following methods will be added to support creating Schemas and Objects.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="createschemalabel-fields"><code>CreateSchema(label, fields)</code><a class="hash-link" href="#createschemalabel-fields" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="parameters">Parameters<a class="hash-link" href="#parameters" title="Direct link to heading">‚Äã</a></h4><p><code>label (string)</code>
: The label for the Schema. Must be alphanumeric and without whitespace.</p><p><code>fields (map[string]int32)</code>
: The properties to be included in the Schema. Each key must be alphanumeric and without whitespace. The value is an integer corresponding to a <code>SchemaKind</code>.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="description">Description<a class="hash-link" href="#description" title="Direct link to heading">‚Äã</a></h4><p>Creates a <em>schema</em> for use throughout Sonr.</p><p>Creating a <em>schema</em> requires a DID and DID Document to be created. </p><blockquote><p>The model itself will be stored in IPFS, while the DID-CID pair is stored on-chain.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="getschema"><code>GetSchema()</code><a class="hash-link" href="#getschema" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="description-1">Description<a class="hash-link" href="#description-1" title="Direct link to heading">‚Äã</a></h4><p>Returns the schema. Requires no blockchain transactions.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="uploadobjectschemadid-data-encryptedjwks"><code>UploadObject(schemaDid, data, encryptedJwks)</code><a class="hash-link" href="#uploadobjectschemadid-data-encryptedjwks" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="parameters-1">Parameters<a class="hash-link" href="#parameters-1" title="Direct link to heading">‚Äã</a></h4><p><code>schemaDid (string)</code>
: The DID of the schema this object adheres to.</p><p><code>data ([]byte)</code>
: The raw data to be added to IPFS. This can be plaintext or encrypted with the user&#x27;s root JWK.</p><p><code>encryptedJwks (map[PK]JWK)</code>
: A map of encrypted JWKs for anyone who should have access to the data. Each JWK must be encrypted with the PK of the shared party.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="description-2">Description<a class="hash-link" href="#description-2" title="Direct link to heading">‚Äã</a></h4><p>Uploads raw data and adds to it IPFS. A CID is returned for addressing the content.</p><blockquote><p>There is no blockchain interactions with this call.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="getobjectcid"><code>GetObject(cid)</code><a class="hash-link" href="#getobjectcid" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="parameters-2">Parameters<a class="hash-link" href="#parameters-2" title="Direct link to heading">‚Äã</a></h4><p><code>cid (string)</code>
The CID which addresses the content on IPFS.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="description-3">Description<a class="hash-link" href="#description-3" title="Direct link to heading">‚Äã</a></h4><p>Returns the object previously uploaded to IPFS, including the map of JWKs. The map can be used to look up and decrypt the appropraite JWK in order to read the data.</p><blockquote><p>This call requires no blockchain interaction.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="whois-updates">WhoIs Updates<a class="hash-link" href="#whois-updates" title="Direct link to heading">‚Äã</a></h2><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Metadata attached associated with the document</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// data is arbitrary, and thus user specified.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Metadata </span><span class="token keyword" style="font-style:italic">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="did-document-verification-definition">DID Document Verification Definition<a class="hash-link" href="#did-document-verification-definition" title="Direct link to heading">‚Äã</a></h2><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Connected Motors Webauthn credentials get stored as verificationMethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;verificationMethod&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Set to Motor Nodes Wallet Address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;controller&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;did:snr:123&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Id of Key set to unique value and operating system/architecture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;did:snr:123#ios-arm64-1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// JWK generated from WebAuthN Credential</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;publicKeyJwk&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;crv&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;P-256&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;kty&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;EC&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;x&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;UANQ8pgvJT33JbrnwMiu1L1JCGQFOEm1ThaNAJcFrWA=&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;y&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;UWm6q5n1iXyeCJLMGDInN40bkkKr8KkoTWDqJBZQXRo=&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;JsonWebKey2020&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="ipld-codec">IPLD Codec<a class="hash-link" href="#ipld-codec" title="Direct link to heading">‚Äã</a></h3><p>DAG-JOSE is a codec that implements the IPLD Data Model as a subset of <code>JOSE</code>, which complies with the <code>DAG-CBOR</code> specication. Some additional constraints for hash consistent representations. DAG-CBOR also adds a &quot;link&quot; type using a CBOR tag to bring it in line with the IPLD <a href="https://ipld.io/glossary/#data-model" target="_blank" rel="noopener noreferrer">Data Model</a>. <a href="https://github.com/ceramicnetwork/go-dag-jose" target="_blank" rel="noopener noreferrer">go implementation</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ipld-pathing">IPLD Pathing<a class="hash-link" href="#ipld-pathing" title="Direct link to heading">‚Äã</a></h3><p>Paths are composed of a series of segments, and each segment is an instruction on how to navigate deeper into the filesystem. With filesystems, each step is over a &quot;directory&quot; and leads you to either a &quot;file&quot; or another &quot;directory&quot;; for IPLD, each step is over a &quot;node&quot; and leads you to another &quot;node&quot;!</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="did-methods-for-cbor-jose-support">DID Methods for CBOR-JOSE support<a class="hash-link" href="#did-methods-for-cbor-jose-support" title="Direct link to heading">‚Äã</a></h2><p>The following methods will need to be implemented within <strong>sonr-io/sonr/pkg/did</strong> for DAG-JOSE support for Sonr DID Documents.</p><ul><li>Authenticate</li><li>CreateJWS</li><li>DecryptJWE</li><li>EnctyptJWE</li><li>VerifyJWS</li></ul><p><strong>Models</strong></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CreateJWSOptions {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    did: string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    protected: map[string]interface{} (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    linkedBlock: string (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DagJWS = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  payload: string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  signatures: []JWSSignature</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  link: CID (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">VerifyJWSOptions {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  atTime: Date (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  disableTimecheck: boolean (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  issuer: string (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  capability: Cacao (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  revocationPhaseOutSecs: number (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">EncryptJWE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cleartext: []byte,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    recipients: []string,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    protectedHeader: map[string]interface{}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    aad: []byte (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DecryptJWEOptions {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  did: string (optional)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="methods">Methods<a class="hash-link" href="#methods" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="authenticate">Authenticate<a class="hash-link" href="#authenticate" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="description-4">Description<a class="hash-link" href="#description-4" title="Direct link to heading">‚Äã</a></h4><p>DID Authentication communicates with the remote origin of DID document to gain the <code>JWS</code> or <code>siganture</code>. Said <code>JWS</code> is then <code>verified</code>.
the following operations are important for proper authentication compliance</p><ul><li>Check the returned <code>kid</code> includes the did from the verification payload.</li><li>Check experation of the signature</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="parameters-3">Parameters<a class="hash-link" href="#parameters-3" title="Direct link to heading">‚Äã</a></h4><p><strong>provider</strong> - DIDProvider.
<strong>paths</strong> - didUrl(s) to authenticate
<strong>aud</strong> - Audience (JWS claim)</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="returns">Returns<a class="hash-link" href="#returns" title="Direct link to heading">‚Äã</a></h4><p>A JWS with general serialization containing the following properties:</p><p><code>nonce</code>
: The random string which was given as a challenge</p><p><code>did</code>
: The DID which authentication was given for</p><p><code>paths</code>
: The paths which was given permission for</p><p><code>exp</code>
: Unix timestamp after which the JWS should be considered invalid.</p><p><code>aud</code>
: optional audience for the JWS, should match the domain which made the request.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="createjws">CreateJWS<a class="hash-link" href="#createjws" title="Direct link to heading">‚Äã</a></h3><p>Generates a JSON web signature object composed of a multi signature key.</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;link&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;/&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;bafybeig6xv5nwphfmvcnektpnojts33jqcuam7bmye2pb54adnrtccjlsu&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;payload&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;AXASIN69ets85WVE0ipva5M5b2mAqAZ8LME08PeAG2MxCSuV&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;signatures&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;protected&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eyJhbGciOiJFUzI1NksifQ&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;signature&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SiYGXW7Yi-KxbpIlLNmu0lEhrayV7ypaAC49GAcQ_qpTstZW89Mz6Cp8VlUEX-qVsgYjc-9-1zvLcDYlxOsr1g&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;protected&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eyJhbGciOiJFUzI1NksifQ&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;signature&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Q8PdTE5A5N3a0ktO2wNdUymumHlSxNF9Si38IvzsMaSZC63yQw-bJNpKf-UeJFPH7cDzY7jLg2G_viejp7NqXg&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="params">Params<a class="hash-link" href="#params" title="Direct link to heading">‚Äã</a></h3><p><code>payload</code>
: The payload to sign, json object or base64url encoded string.</p><p><code>protected</code>
: The protected header, json object.</p><p><code>did</code>
: The DID that should sign the message, may include the key, fragment.</p><p><code>revocable</code>
: Makes the JWS revocable when rotating keys, boolean default to false</p><p><strong>Returns</strong>: <code>DAGJws</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="verifyjws">VerifyJWS<a class="hash-link" href="#verifyjws" title="Direct link to heading">‚Äã</a></h3><h3 class="anchor anchorWithStickyNavbar_mojV" id="description-5">Description<a class="hash-link" href="#description-5" title="Direct link to heading">‚Äã</a></h3><p>We can compute the <code>SHA-256</code> representation if the specified <code>secret</code> is present within the generated token. Upon querying for an ecrypted entry within ipfs, the DID controller of said object should be able to <code>verify</code> the signature as it should be aware of valid signatures relating to itself.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="params-1">Params<a class="hash-link" href="#params-1" title="Direct link to heading">‚Äã</a></h3><p><code>jws</code>
: signature to verify</p><p><code>options</code>
: VeriftyJWSOptions</p><p><strong>Returns</strong></p><h1>Object Schemas</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="ipld-object-schema">IPLD Object Schema<a class="hash-link" href="#ipld-object-schema" title="Direct link to heading">‚Äã</a></h2><p>IPLD represents data types which can be stored in IPFS nodes as ‚ÄúKinds‚Äù the following are types which ‚ÄúKinds‚Äù support:</p><ul><li><code>boolean</code></li><li><code>integer</code></li><li><code>float</code></li><li><code>map</code></li><li><code>list</code></li><li><code>string</code></li><li><code>null</code></li><li><code>bytes</code></li><li><code>link</code></li></ul><p>Kinds in IPLD are similar to data types supported within ‚ÄúJSON‚Äù but also add ‚Äúbytes‚Äù and ‚Äúlink‚Äù where link maps to ‚ÄúCID‚Äù type.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="dsl-representation-of-object-schema">DSL Representation of Object Schema<a class="hash-link" href="#dsl-representation-of-object-schema" title="Direct link to heading">‚Äã</a></h2><p>Node builders allow you to declare schema within an object representation that then can be transformed to various types. Builders then can be represented in DSL which is a declarative syntax for IPLD schemas similar to JSON.  The following is a method stub for creating an object schema for later usage.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="createobjectschema">CreateObjectSchema<a class="hash-link" href="#createobjectschema" title="Direct link to heading">‚Äã</a></h2><p>Creation of an object will define a schema for objects to be later stored in IPFS. <code>Schemas</code> define the shape of data for a given object.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="putobjectschema">PutObjectSchema<a class="hash-link" href="#putobjectschema" title="Direct link to heading">‚Äã</a></h2><p><code>func (i *IPFSProtocol) PutObjectSchema(doc *ot.ObjectDoc) (*cid.Cid, error)</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="implementation-using-ipld-node-builder">Implementation using IPLD Node Builder<a class="hash-link" href="#implementation-using-ipld-node-builder" title="Direct link to heading">‚Äã</a></h3><p>Stores a DSL representation of a defined object schema with the following relationship denoting a property of the persistent schema.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Label: string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Type: Kind</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>This object will be stored within an aggregate (array structure) within the ObjectDoc and should be iterated over and stored within a node builder, then serialized to a byte representation.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="getobjectschema">GetObjectSchema<a class="hash-link" href="#getobjectschema" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="function-signature">Function Signature<a class="hash-link" href="#function-signature" title="Direct link to heading">‚Äã</a></h3><p><code>func (i *IPFSProtocol) GetObjectSchema(cid *CID) (Node, error)</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="implementation-string-repersentation-of-schema">Implementation (string repersentation of schema)<a class="hash-link" href="#implementation-string-repersentation-of-schema" title="Direct link to heading">‚Äã</a></h3><p>Instead of using a <code>node builder</code> to build our schema up from a tree of related objects, the schema structured can be <code>loaded</code> from a string repersentation of the <code>ipld</code> schema:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;foo&quot;: string,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;baz&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;prop&quot;: integer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The above repersentation can be serialized to a Byte Array, and loaded as a static schema structure. Therefore, we can then store this structure as a schema for schemas as the following:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;schema&quot;: []byte,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>schema</code>
: Schema decleration as an array of bytes.</p><h1>Interaction Methods for Highway to Motor Communication</h1><p>The following are interface methods that should be defined on <code>Host</code> and implemented for Host targets.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="accessapp"><code>AccessApp()</code><a class="hash-link" href="#accessapp" title="Direct link to heading">‚Äã</a></h2><p>User authenticates a Registered Application on Sonr with their DID Based Multisignature key for all their devices. Creates a new Bucket inside the User bucket for the newly provisioned Application.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="interactobject"><code>InteractObject()</code><a class="hash-link" href="#interactobject" title="Direct link to heading">‚Äã</a></h2><p>Maps user defined object to a <code>object schema</code>. Which is then pushed to a bucket. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="readobject"><code>ReadObject()</code><a class="hash-link" href="#readobject" title="Direct link to heading">‚Äã</a></h2><p>This method begins the request process for reading the individual object values of another User&#x27;s app bucket. Provisioned users will automatically get access (if they called RequestBucket already) and unprovisioned users will send the RequestBucket to the corresponding peer.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/articles/reference/ADR-002.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/articles/reference/adr-001"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ADR-001</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/articles/reference/adr-003"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ADR-003</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#primer" class="table-of-contents__link toc-highlight">Primer</a></li><li><a href="#glossary" class="table-of-contents__link toc-highlight">Glossary</a><ul><li><a href="#identity" class="table-of-contents__link toc-highlight"><code>Identity</code></a></li></ul></li><li><a href="#objective" class="table-of-contents__link toc-highlight">Objective</a></li><li><a href="#changes-from-adr-001" class="table-of-contents__link toc-highlight">Changes From ADR-001</a></li><li><a href="#client-side-encryption-with-jose" class="table-of-contents__link toc-highlight">Client-Side Encryption with JOSE</a><ul><li><a href="#encryption" class="table-of-contents__link toc-highlight">Encryption</a></li><li><a href="#decrypting" class="table-of-contents__link toc-highlight">Decrypting</a></li><li><a href="#revoking-access" class="table-of-contents__link toc-highlight">Revoking Access</a></li></ul></li><li><a href="#adding-verification-methods" class="table-of-contents__link toc-highlight">Adding Verification Methods</a></li><li><a href="#schema-model" class="table-of-contents__link toc-highlight">Schema Model</a></li><li><a href="#object-model" class="table-of-contents__link toc-highlight">Object Model</a></li><li><a href="#object-schema-api-blockchain" class="table-of-contents__link toc-highlight">Object Schema API (Blockchain)</a><ul><li><a href="#createschemalabel-fields" class="table-of-contents__link toc-highlight"><code>CreateSchema(label, fields)</code></a></li><li><a href="#getschema" class="table-of-contents__link toc-highlight"><code>GetSchema()</code></a></li><li><a href="#uploadobjectschemadid-data-encryptedjwks" class="table-of-contents__link toc-highlight"><code>UploadObject(schemaDid, data, encryptedJwks)</code></a></li><li><a href="#getobjectcid" class="table-of-contents__link toc-highlight"><code>GetObject(cid)</code></a></li></ul></li><li><a href="#whois-updates" class="table-of-contents__link toc-highlight">WhoIs Updates</a></li><li><a href="#did-document-verification-definition" class="table-of-contents__link toc-highlight">DID Document Verification Definition</a><ul><li><a href="#ipld-codec" class="table-of-contents__link toc-highlight">IPLD Codec</a></li><li><a href="#ipld-pathing" class="table-of-contents__link toc-highlight">IPLD Pathing</a></li></ul></li><li><a href="#did-methods-for-cbor-jose-support" class="table-of-contents__link toc-highlight">DID Methods for CBOR-JOSE support</a></li><li><a href="#methods" class="table-of-contents__link toc-highlight">Methods</a><ul><li><a href="#authenticate" class="table-of-contents__link toc-highlight">Authenticate</a></li><li><a href="#createjws" class="table-of-contents__link toc-highlight">CreateJWS</a></li><li><a href="#params" class="table-of-contents__link toc-highlight">Params</a></li><li><a href="#verifyjws" class="table-of-contents__link toc-highlight">VerifyJWS</a></li><li><a href="#description-5" class="table-of-contents__link toc-highlight">Description</a></li><li><a href="#params-1" class="table-of-contents__link toc-highlight">Params</a></li></ul></li><li><a href="#ipld-object-schema" class="table-of-contents__link toc-highlight">IPLD Object Schema</a></li><li><a href="#dsl-representation-of-object-schema" class="table-of-contents__link toc-highlight">DSL Representation of Object Schema</a></li><li><a href="#createobjectschema" class="table-of-contents__link toc-highlight">CreateObjectSchema</a></li><li><a href="#putobjectschema" class="table-of-contents__link toc-highlight">PutObjectSchema</a><ul><li><a href="#implementation-using-ipld-node-builder" class="table-of-contents__link toc-highlight">Implementation using IPLD Node Builder</a></li></ul></li><li><a href="#getobjectschema" class="table-of-contents__link toc-highlight">GetObjectSchema</a><ul><li><a href="#function-signature" class="table-of-contents__link toc-highlight">Function Signature</a></li><li><a href="#implementation-string-repersentation-of-schema" class="table-of-contents__link toc-highlight">Implementation (string repersentation of schema)</a></li></ul></li><li><a href="#accessapp" class="table-of-contents__link toc-highlight"><code>AccessApp()</code></a></li><li><a href="#interactobject" class="table-of-contents__link toc-highlight"><code>InteractObject()</code></a></li><li><a href="#readobject" class="table-of-contents__link toc-highlight"><code>ReadObject()</code></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/sonr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://sonr.buzz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/SonrProtocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Specifications</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/sonr-io/sonr/wiki/ADR-001:-Sonr-DID-Specification" target="_blank" rel="noopener noreferrer" class="footer__link-item">DID Method<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.figma.com/file/wUulpz1zcRVcj1f2KMQjWB/Sonr-Architecture?node-id=0%3A1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Network Architecture<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/sonr-io/sonr" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Sonr Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8169f229.js"></script>
<script src="/assets/js/main.a70c422f.js"></script>
</body>
</html>