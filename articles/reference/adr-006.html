<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/adr-006">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<title data-rh="true">ADR-006 | Sonr Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://sonr-io.github.io/articles/reference/adr-006"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ADR-006 | Sonr Docs"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sonr-io.github.io/articles/reference/adr-006"><link data-rh="true" rel="alternate" href="https://sonr-io.github.io/articles/reference/adr-006" hreflang="en"><link data-rh="true" rel="alternate" href="https://sonr-io.github.io/articles/reference/adr-006" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.bbb29084.css">
<link rel="preload" href="/assets/js/runtime~main.0b530313.js" as="script">
<link rel="preload" href="/assets/js/main.b537a16d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Sonr Docs Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="Sonr Docs Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><a class="navbar__item navbar__link" href="/articles/introduction">Learn the Basics</a><a class="navbar__item navbar__link" href="/articles/run-nodes/setup-validator">Run Nodes</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Build Apps</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/articles/highway-sdk/using-cli">Highway SDK</a></li><li><a class="dropdown__link" href="/articles/motor-node/installation">Motor Library</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-overview">ADR Overview</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-001">ADR-001</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-002">ADR-002</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-003">ADR-003</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-004">ADR-004</a></li><li><a class="dropdown__link navbar__link--active" href="/articles/reference/adr-005">ADR-005</a></li><li><a aria-current="page" class="dropdown__link navbar__link--active" href="/articles/reference/adr-006">ADR-006</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">API Reference</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/highway">üõ£ Highway API</a></li><li><a class="dropdown__link" href="/blockchain">‚õì Blockchain API</a></li></ul></div><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-overview">ADR Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-001">ADR-001</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-002">ADR-002</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-003">ADR-003</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-004">ADR-004</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/reference/adr-005">ADR-005</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/articles/reference/adr-006">ADR-006</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">ADR-006</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ADR-006: Deployable Functions</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">‚Äã</a></h2><p>Implement user defined functions invokable over HTTP within Highway.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="abstract">Abstract<a class="hash-link" href="#abstract" title="Direct link to heading">‚Äã</a></h2><p>The goal of user-defined functions is to allow for custom-defined behavior, defined by users which are accessible via <code>HTTP</code>.
These functions will all be accessible over a single endpoint, predefined within the highway.</p><p>When a request is sent to a static endpoint, containing the desired name of the invokable function, the function will be then invoked, with a single parameter queried from <code>ipfs</code> by the given <code>CID</code> in the declaration of the url.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="user-functions">User functions<a class="hash-link" href="#user-functions" title="Direct link to heading">‚Äã</a></h2><p>A User <code>Defined Function</code> is repersented by a single <code>binary</code> file which is assumed to be executable, and corresponding <code>callback Urls</code> associated with said executable file. said functions are not permitted to return data to the caller directly, but rather the outer managment of the defined function will provide data to the given <code>urls</code> as <code>base64 encoded</code> repersentations as to not permit users to modify the system state of any <code>highway</code> node directly.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="function-definition-format">Function definition format<a class="hash-link" href="#function-definition-format" title="Direct link to heading">‚Äã</a></h3><p>The user&#x27;s defined function is assumed to be precompiled into binary format. Said Binary is <code>jailed</code> as to resrtrict privlages on the execution enviorment to the host.</p><p>Currently, the executable options are more appealing as it is easier to sandbox a plain binary into a ‚Äòjail‚Äô rather than implementing sandboxing around a reflection execution implementation.
Below is a primitive definition for a user-defined function.
Said binary is stored within the highway node&#x27;s <code>ipfs</code> storage with the following file contents as a blob of <code>JSON</code></p><div class="codeBlockContainer_I0IT language-go= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-go= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">UserFunction {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    did string // did from defintion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file []bytes // file as a byte encoding</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    parameters: map[string]string // not the value string is the &quot;type&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><blockquote><p>In the above definition, the total size of the file stored for a user function would be the total bytes of the array and the did string of the owner.
This data would be stored on IPFS incurring the cost of file storage and passing that on to the uploader of the function.</p></blockquote><p>Once a function is associated with a name and provided to the highway, a function will then have the association of label ‚Üí function.
Each function will be a single relation to the user-given function.
Meaning a function can be resolved via its name <code>name</code> but a function cannot resolve its name, as the function is not explicitly required to have an associative name that matches its function name.</p><div class="codeBlockContainer_I0IT language-go= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-go= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    did: string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ref: cid</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    isActive: boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><blockquote><p>The above model will be stored within the chain upon <code>creation</code> and <code>update</code>. This chain store will incur a cost on the uploader. Later changing the function to inactive will also incur a cost on chain.</p></blockquote><p>The above model is then stored as a file in <code>IPFS</code> queriable by the returned <code>CID</code>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="url-schema">URL Schema<a class="hash-link" href="#url-schema" title="Direct link to heading">‚Äã</a></h2><p>User Defined functions within the Highway will have a single entry point. </p><p><code>/sonr/functions/invoke/{version}/{label}</code></p><p>Where <code>label</code> is defined when the definition of the function is created.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="params-to-a-user-defined-function-over-url">params to a user defined function over URL<a class="hash-link" href="#params-to-a-user-defined-function-over-url" title="Direct link to heading">‚Äã</a></h3><p>callback? (base64 encoding).
cid? (id of the content from a highway node you wish to provide to a function)
the above URL has two params </p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>queryCid</td><td>string</td><td>Content ID to be retrieved from file storage (object, blob)</td></tr><tr><td>returnData</td><td>string</td><td>A <code>URL</code> that will be called and given the returned data from a function</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="function-parameters">Function Parameters<a class="hash-link" href="#function-parameters" title="Direct link to heading">‚Äã</a></h2><p>Parameters to functions will be nameless and of type <code>string</code>. the provided data will be deserailized to the described types and given to functions as what they are specified to be in the delceration upon creation. Parameters to functions will be applied in the order as they are provided, content queried by the <code>CID</code> provided URL when the function is invoked will be the last parameter to the function. The function implementor is responsible for the mapping of the parameters based on the index when implementing.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="returning-data-from-a-user-defined-function">Returning data from a user defined function<a class="hash-link" href="#returning-data-from-a-user-defined-function" title="Direct link to heading">‚Äã</a></h2><p>User defined functions cannot modify the state of <code>highways</code>, meaning data stored within the network. Instead one or many <code>callback URLs</code> are specifiable, allowing for data to be sent to said urls through <code>url encoding</code> data return by any function must be <code>encodable</code> to <code>Base64</code> standard or data will not be sent.</p><p>The <code>callback URLs</code> can be either an external resource outside of the network of highways, or can be another function defined on the highway.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="invoking-a-user-defined-function">Invoking a User Defined Function<a class="hash-link" href="#invoking-a-user-defined-function" title="Direct link to heading">‚Äã</a></h2><p>A function that&#x27;s invoked should have the following defined within the <code>body</code> of the <code>HTTP</code> request</p><div class="codeBlockContainer_I0IT language-= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    did string // owner did</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label: string // file as a byte encoding</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cid: string // identifier of the function stored within ipfs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    parameters: map[string]string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    callbackURLS: string[]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The return value will simply be an empty response body with an <code>HTTP</code> status.</p><p>When a function is &quot;invoked&quot; we will use one of the following strategies for calulating cost for a given function&#x27;s invokation.</p><table><tr><th></th><th>Description</th><th>Formula</th><th>User Pays</th><th>Highway Runner Gets</th><th>Function Writer Gets</th></tr><tr><td>Static Cost Functions</td><td>Cost is staticly defined at function creation time. The run time cost is added in addition to the cost paid by the caller</td><td>total_cost = static_cost + runtime_fees</td><td>total_cost</td><td>runtime_fees</td><td>static_cost</td></tr><tr><td>Variable Cost Functions</td><td>Cost is defined when the function is running. There is a max and min cost that can be paid from the caller&#x27;s wallet predefined in the function definition. The caller will also need to fund a transaction to refund the remainder of the gas fees to caller.</td><td>total_cost = variable_cost + runtime_fees + gas_fees</td><td>total_cost</td><td>runtime_fees</td><td>variable_cost</td></tr><tr><td>&quot;Free&quot; Functions</td><td>The function only costs as much as the runtime_fees</td><td>total_cost = runtime_fees</td><td>total_cost</td><td>runtime_fees</td><td>N/A</td></tr></table><blockquote><p>Static and Varible functions are useful when the function needs to make its own interaction with the chain or fund calls within. </p></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="models-and-methods-highway">Models and Methods (Highway)<a class="hash-link" href="#models-and-methods-highway" title="Direct link to heading">‚Äã</a></h2><p>The following methods will be added to <code>Highway</code> as a module within <code>x</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="methods">Methods<a class="hash-link" href="#methods" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="createfunction">CreateFunction()<a class="hash-link" href="#createfunction" title="Direct link to heading">‚Äã</a></h4><p>Creates a new function with the provided <code>label</code> and <code>definition</code> (function converted to <code>bytes</code>)</p><div class="codeBlockContainer_I0IT language-go= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-go= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">type FunctionDefiniton struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    did string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    definition []byte</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        parameters: map[string]type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Returns</strong></p><div class="codeBlockContainer_I0IT language-json= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-json= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;code&quot;: int,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;did&quot;: &quot;string&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;cid&quot;: &quot;string&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="updatefunction">UpdateFunction()<a class="hash-link" href="#updatefunction" title="Direct link to heading">‚Äã</a></h4><div class="codeBlockContainer_I0IT language-go= theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-go= codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">type FunctionDefiniton struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    did string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    definition []byte </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><blockquote><p>Updating a function does not remove the previous function defintion, as there could be reliance on said function. Updating a function creates a new instance of an already defined function by requiring a new  version specified in the URL.</p></blockquote><p><strong>Returns</strong></p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;code&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;did&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;string&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;cid&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;string&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="cli-commands">CLI Commands<a class="hash-link" href="#cli-commands" title="Direct link to heading">‚Äã</a></h2><p>The CLI will need a single root level command called <code>function</code>. function will have the following two sub commands</p><table><thead><tr><th>Name</th><th>params</th><th>Description</th></tr></thead><tbody><tr><td>add</td><td>&quot;name&quot; &quot;path-to-binary&quot;</td><td>Adds a single function to a defined name</td></tr><tr><td>remove</td><td>&quot;name&quot;</td><td>Removes user defined function from the function table</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="diagrams">Diagrams<a class="hash-link" href="#diagrams" title="Direct link to heading">‚Äã</a></h2><p><a href="https://www.figma.com/embed?embed_host=share&amp;url=https%3A%2F%2Fwww.figma.com%2Ffile%2Fv9E6Om23rm80JROFHVnr31%2FHighway-sdk-user-defined-functions-(non-faas)%3Fnode-id%3D0%253A1" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Writing encrypted data" src="/assets/images/user-functions-adr-6-560d79af0f23f4cbc003936825402222.png" width="2268" height="1476" class="img_E7b_"></a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/articles/reference/ADR-006.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/articles/reference/adr-005"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ADR-005</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#user-functions" class="table-of-contents__link toc-highlight">User functions</a><ul><li><a href="#function-definition-format" class="table-of-contents__link toc-highlight">Function definition format</a></li></ul></li><li><a href="#url-schema" class="table-of-contents__link toc-highlight">URL Schema</a><ul><li><a href="#params-to-a-user-defined-function-over-url" class="table-of-contents__link toc-highlight">params to a user defined function over URL</a></li></ul></li><li><a href="#function-parameters" class="table-of-contents__link toc-highlight">Function Parameters</a></li><li><a href="#returning-data-from-a-user-defined-function" class="table-of-contents__link toc-highlight">Returning data from a user defined function</a></li><li><a href="#invoking-a-user-defined-function" class="table-of-contents__link toc-highlight">Invoking a User Defined Function</a></li><li><a href="#models-and-methods-highway" class="table-of-contents__link toc-highlight">Models and Methods (Highway)</a><ul><li><a href="#methods" class="table-of-contents__link toc-highlight">Methods</a></li></ul></li><li><a href="#cli-commands" class="table-of-contents__link toc-highlight">CLI Commands</a></li><li><a href="#diagrams" class="table-of-contents__link toc-highlight">Diagrams</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/sonr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://sonr.buzz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/SonrProtocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Specifications</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/sonr-io/sonr/wiki/ADR-001:-Sonr-DID-Specification" target="_blank" rel="noopener noreferrer" class="footer__link-item">DID Method<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.figma.com/file/wUulpz1zcRVcj1f2KMQjWB/Sonr-Architecture?node-id=0%3A1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Network Architecture<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/sonr-io/sonr" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Sonr Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0b530313.js"></script>
<script src="/assets/js/main.b537a16d.js"></script>
</body>
</html>